{% extends 'auction_store/base.html' %}
{% block content %}
{% load static %}
{% load crispy_forms_tags %}
{% load crispy_forms_field %}
<div class="container-fluid mt-2"><!-- container -->
<div class="row">

 <div class="col-12 col-lg-3 mt-2 mb-5 px-5 ">
  <div class="row bg-primary p-3">
  <form action="" method="GET">
    {% csrf_token %}
    <div class="form-row">
      <div class="form-group col-12 font-weight-bold text-white mb-0">
        {{ filterset.form.category|as_crispy_field }}
      </div>
      <div class="form-group col-12 font-weight-bold text-white mb-0">
       {{ filterset.form.price|as_crispy_field }}
      </div>
      <div class="form-group col-12 font-weight-bold text-white mb-0">
        {{ filterset.form.format|as_crispy_field }}
      </div>
      <div class="form-group col-12 font-weight-bold text-white mb-0">
        {{ filterset.form.sort|as_crispy_field }}
      </div>
    </div>
    <button class="btn btn-warning col-6 offset-3 mt-2"
    type="submit">Search</button>
  </form>
</div>
 </div>

<div class="col-12 col-lg-9 px-0">
 {% for item in object_list %}
 <div class="row card-row my-1">
  <div class="col-12 col-lg-4 p-0">
    {% if item.sold %}
     <img class="layered-image img-fluid" src="{{ item.image.url }}">
     <img class="image-overlay-store img-fluid" src="{% static 'img/soldd.png' %}">
    {% elif not item.sold and item.today_date <= item.finish_date %}
     <img class="image-time-store img-fluid" src="{% static 'img/hammer.png' %}">
     <img class="layered-image img-fluid" src="{{ item.image.url }}">
    {% elif not item.sold and item.today_date >= item.finish_date %}
     {% if item.winner is None %}
      <img class="layered-image img-fluid" src="{{ item.image.url }}">
     {% else %}
      <img id="filtered-img" class="layered-image img-fluid" src="{{ item.image.url }}">
     {% endif %}
    {% else %}
     <img class="layered-image img-fluid" src="{{ item.image.url }}">
    {% endif %}
  </div>
  <div class="col-12 col-lg-8 p-0">
   <div class="card h-100 text-center border border-white">
    <div class="card-header py-1 bg-muted">
    <h5 class="card-title m-0">
      <a href="{% url 'item-detail' item.id %}">{{ item.name }}</a>
      {% if not item.sold and item.today_date <= item.finish_date %}
      <i class="fas fa-hourglass-half auction_lasts pl-1 text-secondary"></i>
      {% elif not item.sold and item.today_date >= item.finish_date %}
      <i class="fas fa-hourglass-end auction_lasts pl-1 text-secondary"></i>
      {% endif %}
    </h5>
   </div>
   <div class="card-body">
    <div class="col-12 py-1">
      <p class="text-left m-auto">{{ item.desc }}</p>
    </div>
   </div>
   <div class="card-footer text-muted p-0">
    Last Bid: {{ item.start_date }}
   </div>
   </div>
  </div>
 </div>
 {% endfor %}
</div><!-- col-8 -->
</div><!-- row -->
{% if is_paginated %}
<div class="text-center pt-3 pb-2">
  {% if page_obj.has_previous %}
    <a class="btn btn-outline mb-4 page-btn" href="?page=1">First</a>
    <a class="btn btn-outline mb-4 page-btn" href="?page={{ page_obj.previous_page_number }}">Previous</a>
  {% endif %}

  {% for num in page_obj.paginator.page_range %}
    {% if page_obj.number == num %}
      <a class="btn  mb-4 page-btn" href="?page={{ num }}">{{ num }}</a>
    {% elif num > page_obj.number|add:'-3' and num < page_obj.number|add:'3' %}
      <a class="btn btn-outline mb-4 page-btn" href="?page={{ num }}">{{ num }}</a>
    {% endif %}
  {% endfor %}

  {% if page_obj.has_next %}
    <a class="btn btn-outline mb-4 page-btn" href="?page={{ page_obj.next_page_number }}">Next</a>
    <a class="btn btn-outline mb-4 page-btn" href="?page={{ page_obj.paginator.num_pages }}">Last</a>
  {% endif %}
</div>
{% endif %}
</div><!-- container -->

<script>
  var euroSign = document.getElementById('id_price');
  euroSign.setAttribute("placeholder", "â‚¬");
</script>
{% endblock %}


